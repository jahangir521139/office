---
- name: Check browser versions on Windows hosts
  hosts: all
  gather_facts: no

  tasks:
    - name: Get Microsoft Edge version
      win_shell: |
        $paths = @(
          'C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe',
          'C:\Program Files\Microsoft\Edge\Application\msedge.exe'
        )
        foreach ($path in $paths) {
          if (Test-Path $path) {
            (Get-Item $path).VersionInfo.ProductVersion
            break
          }
        }
      register: edge_version
      ignore_errors: true

    - name: Get Google Chrome version
      win_shell: |
        $paths = @(
          'C:\Program Files\Google\Chrome\Application\chrome.exe',
          'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe'
        )
        foreach ($path in $paths) {
          if (Test-Path $path) {
            (Get-Item $path).VersionInfo.ProductVersion
            break
          }
        }
      register: chrome_version
      ignore_errors: true

    - name: Get Mozilla Firefox version
      win_shell: |
        $paths = @(
          'C:\Program Files\Mozilla Firefox\firefox.exe',
          'C:\Program Files (x86)\Mozilla Firefox\firefox.exe'
        )
        foreach ($path in $paths) {
          if (Test-Path $path) {
            (Get-Item $path).VersionInfo.ProductVersion
            break
          }
        }
      register: firefox_version
      ignore_errors: true

    - name: Print browser versions
      debug:
        msg: |
          Host: {{ inventory_hostname }}
          Edge: {{ edge_version.stdout | default('Not found') }}
          Chrome: {{ chrome_version.stdout | default('Not found') }}
          Firefox: {{ firefox_version.stdout | default('Not found') }}
